{
  "type": "object",
  "required": ["artifacts", "quality", "meeting_summary_for_context"],
  "properties": {
    "meeting_summary_for_context": {
      "type": "string",
      "description": "Сжатый контекст встречи для последующего использования"
    },
    "artifacts": {
      "type": "object",
      "properties": {
        "meta": {
          "type": "object",
          "properties": {
            "brand": { "type": ["string", "null"] },
            "meeting_date": { "type": ["string", "null"] },
            "deal_stage": { "type": ["string", "null"] },
            "source": { "type": ["string", "null"] },
            "participants": {
              "type": "object",
              "properties": {
                "client": { "type": "array", "items": { "type": "string" } },
                "our_team": { "type": "array", "items": { "type": "string" } }
              }
            }
          }
        },
        "client_profile": {
          "type": "object",
          "properties": {
            "company_name": { "type": ["string", "null"] },
            "industry": { "type": ["string", "null"] },
            "business_model": { "type": ["string", "null"] },
            "geo": { "type": ["string", "null"] },
            "current_tools": { "type": "array", "items": { "type": "string" } },
            "team_size_or_users": {
              "type": "object",
              "properties": {
                "value": { "type": ["number", "string", "null"] },
                "unit": { "type": ["string", "null"] },
                "evidence": { "type": ["object", "null"] }
              }
            }
          }
        },
        "pains": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "pain": { "type": "string" },
              "impact": { "type": ["string", "null"] },
              "priority": { "type": ["string", "null"], "enum": ["high", "medium", "low", null] },
              "evidence": {
                "type": "object",
                "properties": {
                  "quote": { "type": "string" },
                  "speaker": { "type": "string", "enum": ["client", "our_team", "unknown"] }
                },
                "required": ["quote", "speaker"]
              }
            },
            "required": ["pain", "evidence"]
          }
        },
        "tasks_and_requirements": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "task": { "type": "string" },
              "category": {
                "type": "string",
                "enum": ["sales", "service", "production", "support", "management", "analytics", "integration", "other"]
              },
              "must_have": { "type": ["boolean", "null"] },
              "details": { "type": ["string", "null"] },
              "evidence": {
                "type": "object",
                "properties": {
                  "quote": { "type": "string" },
                  "speaker": { "type": "string", "enum": ["client", "our_team", "unknown"] }
                },
                "required": ["quote", "speaker"]
              }
            },
            "required": ["task", "category", "evidence"]
          }
        },
        "bitrix24_scope_draft": {
          "type": "object",
          "properties": {
            "license": {
              "type": "object",
              "properties": {
                "needs": { "type": ["string", "null"] },
                "preferred": { "type": ["string", "null"] },
                "evidence": { "type": ["object", "null"] }
              }
            },
            "work_blocks": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "block": {
                    "type": "string",
                    "enum": ["discovery", "setup", "crm_pipeline", "automation", "communications", "telephony", "forms", "open_lines", "tasks_projects", "reports", "integrations", "migration", "training", "support", "other"]
                  },
                  "items": { "type": "array", "items": { "type": "string" } },
                  "evidence": { "type": "array", "items": { "type": "object" } }
                },
                "required": ["block"]
              }
            }
          }
        },
        "proposal_ready_materials": {
          "type": "object",
          "properties": {
            "internal_summary_bullets": { "type": "array", "items": { "type": "string" } },
            "proposal_focus": { "type": "array", "items": { "type": "string" } },
            "client_value_emphasis": { "type": "array", "items": { "type": "string" } },
            "external_recap_2_3_sentences": { "type": "string" }
          }
        }
      }
    },
    "quality": {
      "type": "object",
      "required": ["missing_data_items", "notes"],
      "properties": {
        "missing_data_items": {
          "type": "array",
          "items": { "type": "string" }
        },
        "notes": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    }
  }
}




