# Инструкция по созданию сценария "Презентация КП"

## Подготовка

Убедитесь, что у вас есть:
1. Доступ к системе с правами **ADMIN**
2. Три подготовленных файла:
   - `scenario-cp-presentation-system-prompt.md` - системный промпт
   - `scenario-cp-presentation-output-schema.json` - схема вывода
   - `scenario-cp-presentation-artifacts-config.json` - конфигурация артефактов

---

## Шаг 1: Вход в админ-панель

1. Откройте браузер и перейдите в систему
2. Войдите под учетной записью с ролью **ADMIN**
3. Перейдите в раздел **Администрирование** (Admin)

---

## Шаг 2: Открытие управления сценариями

1. В админ-панели найдите раздел **"Сценарии"** (Scenarios)
2. Нажмите кнопку **"Создать сценарий"** (Create Scenario)
3. Откроется модальное окно создания сценария

---

## Шаг 3: Заполнение формы создания сценария

### 3.1. Тип встречи (Meeting Type)

1. В выпадающем списке **"Тип встречи"** выберите:
   - **"CP Presentation"** (или "Презентация КП" в зависимости от локализации)

**Важно:** Если типа "CP Presentation" нет в списке, его нужно создать сначала в разделе "Типы встреч".

---

### 3.2. Название сценария (Name)

Введите название:
```
Презентация КП - Анализ и обратная связь
```

Или любое другое понятное название, например:
- `Презентация коммерческого предложения`
- `Сценарий презентации КП`

---

### 3.3. Системный промпт (System Prompt)

1. Откройте файл `scenario-cp-presentation-system-prompt.md`
2. Скопируйте **весь текст** из файла (от начала до конца)
3. Вставьте скопированный текст в поле **"Системный промпт"**

**Проверка:** Промпт должен начинаться с "СИСТЕМНЫЙ ПРОМПТ ДЛЯ СЦЕНАРИЯ..." и заканчиваться "...ни одного символа "?" в итоговом JSON."

---

### 3.4. Схема вывода (Output Schema)

1. Откройте файл `scenario-cp-presentation-output-schema.json`
2. Скопируйте **весь JSON** из файла
3. Вставьте в поле **"Схема вывода (JSON)"**

**Важно:** 
- JSON должен быть валидным (без синтаксических ошибок)
- Не добавляйте лишних пробелов или символов
- Можно использовать форматирование (с отступами) или компактный формат

**Проверка:** JSON должен начинаться с `{` и заканчиваться `}`. Первая строка: `{` и последняя: `}`

---

### 3.5. Конфигурация артефактов (Artifacts Config)

1. Откройте файл `scenario-cp-presentation-artifacts-config.json`
2. Скопируйте **весь JSON** из файла
3. Вставьте в поле **"Конфигурация артефактов (JSON)"**

**Проверка:** JSON должен начинаться с `{"sections": [` и содержать 11 секций.

---

### 3.6. Статус активности (Is Active)

1. Убедитесь, что чекбокс **"Активен"** отмечен (включен)
2. Это позволит использовать сценарий при создании встреч

---

## Шаг 4: Проверка перед сохранением

Перед нажатием кнопки "Создать" проверьте:

✅ **Тип встречи** выбран правильно (CP Presentation)  
✅ **Название** заполнено и понятное  
✅ **Системный промпт** скопирован полностью (проверьте начало и конец)  
✅ **Схема вывода** - валидный JSON (можно проверить в JSON валидаторе)  
✅ **Конфигурация артефактов** - валидный JSON  
✅ **Активен** - чекбокс отмечен  

---

## Шаг 5: Создание сценария

1. Нажмите кнопку **"Создать"** (Create)
2. Дождитесь завершения процесса (появится индикатор загрузки)
3. При успешном создании:
   - Модальное окно закроется
   - Сценарий появится в списке сценариев
   - Вы увидите сообщение об успешном создании

---

## Шаг 6: Проверка созданного сценария

1. Найдите созданный сценарий в списке
2. Нажмите кнопку **"Просмотр"** (View) или **"Редактировать"** (Edit)
3. Проверьте, что все данные сохранены корректно:
   - Системный промпт отображается полностью
   - Схема вывода валидна
   - Конфигурация артефактов содержит 11 секций

---

## Возможные ошибки и их решение

### Ошибка: "Неверный формат JSON в схеме или конфигурации"

**Причина:** JSON содержит синтаксические ошибки

**Решение:**
1. Проверьте JSON в валидаторе: https://jsonlint.com/
2. Убедитесь, что все кавычки закрыты
3. Проверьте, что нет лишних запятых в конце массивов/объектов
4. Убедитесь, что скопировали весь JSON без обрезки

---

### Ошибка: "Meeting type not found"

**Причина:** Тип встречи "CP Presentation" не существует в системе

**Решение:**
1. Сначала создайте тип встречи "CP Presentation" в разделе "Типы встреч"
2. Затем повторите создание сценария

---

### Ошибка: "Admin access required"

**Причина:** У вашей учетной записи нет прав администратора

**Решение:**
1. Обратитесь к администратору системы для получения прав ADMIN
2. Или попросите администратора создать сценарий

---

### Ошибка: "Scenario name already exists"

**Причина:** Сценарий с таким названием уже существует

**Решение:**
1. Измените название сценария на уникальное
2. Или найдите существующий сценарий и отредактируйте его

---

## Дополнительные настройки (опционально)

### Ключевые термины (Keyterms)

После создания сценария вы можете добавить ключевые термины для улучшения качества транскрипции:

1. Откройте сценарий для редактирования
2. Найдите поле "Ключевые термины" (если доступно)
3. Добавьте термины, например:
   - `коммерческое предложение`
   - `КП`
   - `Bitrix24`
   - `лицензия`
   - `внедрение`
   - `бюджет`
   - `сроки`

---

## Проверка работоспособности

После создания сценария рекомендуется:

1. **Создать тестовую встречу:**
   - Выберите тип встречи "CP Presentation"
   - Выберите созданный сценарий
   - Загрузите тестовый файл транскрипции

2. **Проверить обработку:**
   - Дождитесь завершения обработки (статус "Ready")
   - Откройте артефакты встречи
   - Проверьте, что все секции отображаются корректно
   - Убедитесь, что данные извлекаются правильно

3. **Проверить валидацию:**
   - Если есть ошибки валидации, проверьте соответствие outputSchema и системного промпта
   - Убедитесь, что LLM возвращает JSON в правильном формате

---

## Готово!

Сценарий "Презентация КП" создан и готов к использованию. Теперь его можно выбирать при создании встреч типа "CP Presentation".

---

## Полезные ссылки на файлы

- Системный промпт: `scenario-cp-presentation-system-prompt.md`
- Схема вывода: `scenario-cp-presentation-output-schema.json`
- Конфигурация артефактов: `scenario-cp-presentation-artifacts-config.json`
- Анализ соответствия: `scenario-cp-presentation-analysis.md`

---

## Примечания

- Все три файла (промпт, schema, config) должны быть согласованы между собой
- После создания сценария его можно редактировать в любое время
- При редактировании версия сценария автоматически увеличивается
- Неактивные сценарии не отображаются при выборе сценария для встречи




